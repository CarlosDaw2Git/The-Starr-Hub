<h2 class="textoBS-primary text-center p-3">Perfil de StarrHub</h2>
<div id="contenidoPerfil" class="container d-flex flex-column">
    <b>Id de usuario: <span id="id"></span></b>
    <b>Nombre de usuario: <span id="nombre"></span></b>
    <b>Contraseña: <span id="clave"></span></b>
    <b>Supercell ID: <span id="spcId"></span></b>
</div>
<div id="perfilBS" class="d-flex justify-content-center p-3"></div>
<div class="container-fluid d-flex justify-content-center p-3">
    <button id="btnCerrarSesion" class="btn btn-danger textoBS-primary">Cerrar sesión</button>
</div>
<script>
    $(document).ready(function(){
        //Obtener los datos del perfil del usuario del Starr Hub
        getDatosPerfil(getValorCookie('userID'))

        $('#btnCerrarSesion').click(function(){
            borrarCookie('userID')
            window.location.reload()
        })
    })

    function getDatosPerfil(idUsuario){
        $.ajax({
        data : {
            'getDatosUsuario' : 'true',
            'idUsuario': idUsuario
        },
        url: './data/BD_Manager.php',
        type: 'POST',
        success: function(datosRecogidos){
            let datosJson = JSON.parse(datosRecogidos)
            $('#id').text(datosJson.user.id)
            $('#nombre').text(datosJson.user.nombre)
            $('#clave').text(datosJson.user.clave)
            let supercellId = datosJson.user_data.supercell_id
            if(supercellId == null){
                $('#spcId').text('No asignado')
            }
            else{
                $('#spcId').text('#'+supercellId)
                $('#perfilBS').append(htmlInfoPerfilBS(supercellId))
                $('#perfilBrawlify').click(function(){
                    window.open('https://brawlify.com/es/stats/profile/'+supercellId, '_blank')
                })
            }
        }
    })
    }

    function htmlInfoPerfilBS(supercellId){
        return '<h4 class="textoBS-primary p-3">Estadísticas del perfil de Brawl Stars:&nbsp;</h4>\
        <button class="btn btn-warning textoBS-primary" id="perfilBrawlify">Acceder al perfil (Página externa)</button>'
    }
</script>